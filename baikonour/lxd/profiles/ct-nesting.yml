---
# NOTES:
# * OverlayFS does not work on top of ZFS : you should use a dedicated filesystem mountpoint (using BTRFS, LVM or dir) through an LXD storage volume to use this driver.
# * OverlayFS does not seems to be 100% supported on top of an 'id mapped mount' (shiftfs on Ubuntu) but containers are running without problems.
# * ZFS can't be nested so we can't use the ZFS driver for Docker/Podman inside an LXD container (but this is possible for BTRFS however)
# * Syscalls required to run OverlayFS in a container (handled by LXD syscalls interception) :
#  - mknod: create device nodes
#  - setxattr: set extended attributes in inodes 
#
config:
  limits.kernel.nofile: 65535
  limits.processes: 1024
  security.nesting: true
  security.syscalls.intercept.mknod: true
  security.syscalls.intercept.setxattr: true
  user.user-data: |
    #cloud-config
    ssh_authorized_keys:
      - ssh-ed25519 <>
description: LXD profile for running nesting containers (incl. Docker/Podman)
devices:
  eth0:
    name: eth0
    nictype: bridged
    parent: lxdbr0
    type: nic
  root:
    path: /
    pool: ssd-zfs
    type: disk
name: ct-default
used_by: []
